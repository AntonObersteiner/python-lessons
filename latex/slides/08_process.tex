
%%	Getting started:
%%	1) Copy this file and name the copy it like the topic it covers
%%	2) In the following make sure to modify the copy, NOT THE ORIGINAL
%%	3) Look for the points marked with "TODO" and complete them
%%	4) compile this file

\input{../templates/slides_template}	% nothing to do here
% TODO change "course_info" to the name of your actual …_info(.tex)
\input{course_info} % TODO modify this if you have not already done so

% meta-information
\newcommand{\topic}{
	% TODO fill in the actual topic
	Subprozesse in Python
}

% nothing to do here
\title{\topic}
\supertitle{\course}
\date{\today}

% the actual document
\begin{document}

\maketitle

\begin{frame}
	\tableofcontents
\end{frame}


\section{Grundlagen}
\subsection{Das Modul subprocess}
\begin{frame}[fragile]{Das Modul subprocess}
	Das Modul \texttt{subprocess} erlaubt die Ausführung externer Befehle und
	Skripte von einem Python Skript aus. Man kann sich die Funktionsweise ähnlich
	der eines Terminals vorstellen.
\end{frame}


\subsection{Eigenschaften}
\begin{frame}[fragile]{Eigenschaften}
	\begin{itemize}
		\item Subprozesse laufen asynchron
		\item Sie laufen direkt auf dem System, nicht in einer Shell
		(wenn nicht anders festgelegt)
		\item Verfügbare Programme hängen vom System ab, auf dem sie ausgeführt werden
		\item Der Aufruf ist allgemeing\"ultig, die Bibliothek verwandelt den
		Aufruf unter Windows in einen kompatiblen \texttt{CreateProcess()} String
	\end{itemize}
\end{frame}


\section{Konstanten}
\subsection{File Descriptoren}
\begin{frame}{File Descriptoren}
	\begin{description}
		\item[DEVNULL] Der systeminterne 'M\"ulleimer'
		\item[PIPE] Die Verbindung zwischen zwei Prozessen
		\item[STDOUT] Die Standardausgabe oder der laufende Prozess
	\end{description}
\end{frame}

\subsection{Exceptions}
\begin{frame}[fragile]{Exceptions}
	\begin{description}
		\item[\texttt{SubprocessError}] Der Standardfehler dieses Moduls
		\item[\texttt{TimeoutError}] Ein Timeout ist aufgetreten
		\item[\texttt{CalledProcessError}] Der Subprozess endete auf eine unerwartete Art
	\end{description}
\end{frame}


\section{Popen Klasse}
\begin{frame}[fragile]{Die Popen Klasse}
	Die \texttt{Popen} Klasse bildet die Basis des Moduls \texttt{subprocess}. \\
	Die Funktionssignatur sieht wie folgt aus:
	\lstinputlisting{resources/08_process/popen_call.py}
\end{frame}

\subsection{Wichtige Argumente}
\begin{frame}[fragile]{Einige wichtige Argumente}
	\begin{description}
		\item[\texttt{args}] Die aufzurufenden Argumente. Sollten vom Typ
			\texttt{tuple} oder \texttt{list} sein. Im Prinzip splittet man den
			Konsolenbefehl an den Leerzeichen: \\
			\texttt{ls -A *.md} entspricht \texttt{['ls', '-A', '*.md']}
		\item[\texttt{shell}] F\"uhrt den Befehl in einer Shell aus.
			Sollte \texttt{False} sein (Standard), sonst ist der Aufruf unsicher.
		\item[\texttt{stdout}] zusammen mit \texttt{stdin} und \texttt{stderr} die Input- und
			Output-Verbindungen des Subprozesses \\
			(hier sind \texttt{DEVNULL}, \texttt{PIPE} und \texttt{STDOUT} n\"utzlich)
		\item[\texttt{env}] Umgebungsvariablen des Kindprozesses. Standard ist ein
			Subset von \texttt{os.environ} (dem Python Prozess Environment)
		\item[\texttt{cwd}] Das Arbeitsverzeichnis des Subprozesses
	\end{description}
\end{frame}


\section{Popen Objekte}
\begin{frame}{Popen Objekte}
	Wenn Popen instanziiert wird, wird der darin enthaltene Prozess gestartet und
	das zurückgegebene \texttt{Popen} Objekt enth\"alt Informationen \"uber den
	laufenden Prozess.
\end{frame}

\subsection{Informationen sammeln}
\begin{frame}[fragile]{Informationen sammeln}
	\begin{itemize}
		\item \texttt{process.args} \\
			Gibt die Argumente zur\"uck, mit denen der Prozess aufgerufen wurde.
		\item \texttt{obj.stdout}, \texttt{obj.stdin}, \texttt{obj.stderr} \\
			Input- und Output-Verbindungen, die beim Start gesetzt wurden
		\item \texttt{process.pid} \\
			Vom System verwendete \textit{Prozess ID}.
		\item \texttt{process.poll()} \\
			Pr\"uft, ob der Prozess beendet wurde. Gibt den \textit{R\"uckgabewert}
			des Prozesses zur\"uck oder \texttt{None}, wenn der Prozess noch l\"auft.
		\item \texttt{process.returncode} \\
			% TODO
			Der R\"uckgabewert von \texttt{process.poll()}.
	\end{itemize}
\end{frame}

\subsection{Interaktion mit dem Prozess}
\begin{frame}[fragile]{Interaktion mit dem Prozess}
	\begin{itemize}
		\item \texttt{process.wait(timeout=None} \\
			Wartet \textit{timeout} Sekunden auf die Terminierung des Prozesses
			(wartet unendlich lang, wenn timeout \textit{None} ist). \\
			Wirft nach Ablauf von \textit{timeout} eine \texttt{TimeoutExpired} Exception.
		\item \texttt{process.send\_signal(signal)} \\
			Sendet das Signal \textit{signal} an den Prozess (z.B. \texttt{SIGTERM}).
	\end{itemize}
\end{frame}

% TODO

\subsection{Nutzung des Kontextmanagers}
% TODO

\section{Vereinfachende Funktionen}
% TODO

% TODO done? place the (sub)section headings correctly
% nothing to do from here on
\end{document}
