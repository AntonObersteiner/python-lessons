\begin{frame}{Advanced functions}

\end{frame}

\begin{frame}[fragile]{Functions as Values}

Functions can be assigned like normal values.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{function(params):}
    \KeywordTok{return} \DecValTok{4}

\NormalTok{my_var = function}

\NormalTok{my_var(}\DecValTok{2}\NormalTok{)  }\CommentTok{# ==> 4}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]

Or passed as parameters.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{callif(boolean, callback):}
    \KeywordTok{if} \NormalTok{boolean:}
        \NormalTok{callback()}

\NormalTok{callif(}\OtherTok{True}\NormalTok{, }\KeywordTok{lambda} \NormalTok{: }\DataTypeTok{print}\NormalTok{(}\StringTok{"hello world"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]{Methods are functions}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{class} \NormalTok{MyClass(}\DataTypeTok{object}\NormalTok{):}
    \KeywordTok{def} \NormalTok{function(}\OtherTok{self}\NormalTok{, param):}
        \KeywordTok{return} \DecValTok{4}


\NormalTok{my_var = MyClass.function}

\NormalTok{my_var(MyClass(), }\DecValTok{2}\NormalTok{)  }\CommentTok{# ==> 4}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]{Default Parameters}

Functions may define default values for their parameters. Parameters
with no default value are also often called positional parameters.
Parameters with default arguments are often called named arguments (we
will see why later).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{greet(name, greeting=}\StringTok{'Hello'}\NormalTok{):}
    \KeywordTok{return} \StringTok{'\{\} \{\}'}\NormalTok{.}\DataTypeTok{format}\NormalTok{(greeting, name)}

\NormalTok{greet(}\StringTok{'Herbert'}\NormalTok{)  }\CommentTok{# ==> 'Hallo Herbert'}
\NormalTok{greet(}\StringTok{'Herbert'}\NormalTok{, }\StringTok{'Gruess Gott'}\NormalTok{)  }\CommentTok{# ==> 'Gruess Gott Herbert'}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]

\begin{block}{Don't}

Ever, EVER, even though the language allows it, make a mutable value the
default value of a function. Mutable Values include \texttt{list},
\texttt{dict}, \texttt{set} and your own classes (more precisely their
attributes).

Immutable values would be \texttt{string}, \texttt{function} (sort of),
\texttt{int}, \texttt{type}and \texttt{None}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{func(param1, param2=[]):}
    \DataTypeTok{print}\NormalTok{(param2)}
    \NormalTok{param2.append(param1)}
\end{Highlighting}
\end{Shaded}

\end{block}

\end{frame}

\begin{frame}[fragile]

One would expect this function to always print the empty list
\texttt{{[}{]}}. However the default param is not recalculated. So what
actually happens is this.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{func(}\DecValTok{1}\NormalTok{)  }\CommentTok{# ==> []}
\NormalTok{func(}\DecValTok{2}\NormalTok{)  }\CommentTok{# ==> [1]}
\NormalTok{func(}\StringTok{'j'}\NormalTok{) }\CommentTok{# ==> [1,2]}
\end{Highlighting}
\end{Shaded}

Bugs like these are truly hard to find.

\end{frame}

\begin{frame}[fragile]

\begin{block}{Do}

If you actually want a mutable value as default, you simply make the
default \texttt{None} and reassign.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{func(param1, param2=}\OtherTok{None}\NormalTok{):}
    \NormalTok{param2 = [] }\KeywordTok{if} \NormalTok{param2 is }\OtherTok{None} \KeywordTok{else} \NormalTok{param2}
    \KeywordTok{pass}
\end{Highlighting}
\end{Shaded}

That is the save way.

\end{block}

\end{frame}

\begin{frame}[fragile]{Call by name}

Function parameters may be provided by their names. When calling
functions by name the order in which the arguments are provided does not
matter.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{land(house, tree, pond):}
    \KeywordTok{return} \StringTok{'You own land with a \{\} a \{\} and a \{\}'}\NormalTok{.}\DataTypeTok{format}\NormalTok{(house, tree, pond)}

\NormalTok{land(}\StringTok{'green house'}\NormalTok{, }\StringTok{'maple'}\NormalTok{, }\StringTok{'fish pond'}\NormalTok{)}
\CommentTok{# or called by name}
\NormalTok{land(house=}\StringTok{'green house'}\NormalTok{, pond=}\StringTok{'fish pond'}\NormalTok{, tree=}\StringTok{'maple'}\NormalTok{)}
\CommentTok{# or mixed}
\NormalTok{land(}\StringTok{'green house'}\NormalTok{, pond=}\StringTok{'fish pond'}\NormalTok{, tree=}\StringTok{'maple'}\NormalTok{)}
\CommentTok{# but THIS does not work}
\NormalTok{land(}\StringTok{'maple'}\NormalTok{, house=}\StringTok{'green house'}\NormalTok{, tree=}\StringTok{'maple'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}

The rule is:

\begin{itemize}
\itemsep1pt\parskip0pt\parsep0pt
\item
  You may call as many parameters position as they wish.
\item
  You may call any parameter by name.
\item
  If a parameter is being called by name, any parameter following it has
  to be called by name as well.
\end{itemize}

\end{frame}

\begin{frame}{Aggregate Parameters}

\end{frame}

\begin{frame}

\begin{block}{Positional}

Every function may have one aggregate parameter. This must be the last
positional parameter. The aggregate parameter is denoted by the operator
\texttt{*} (pronounced `star'). Only named arguments may follow an
aggregate parameter. If an aggregate exists, arguments following it may
only be called by name (obviously).

\end{block}

\end{frame}

\begin{frame}[fragile]

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{function(param1, *aggr, param2=}\DecValTok{0}\NormalTok{):}
    \KeywordTok{pass}
\NormalTok{function(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{)  }\CommentTok{# correct, aggr = (2,3,4)}
\NormalTok{function(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{78}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{90}\NormalTok{,}\DecValTok{0}\NormalTok{)  }
\CommentTok{# also correct, aggr = (2,4,5,6,78,9,90,0)}
\NormalTok{function()  }\CommentTok{# incorrect param1 requires at least one argument}
\NormalTok{function(}\DecValTok{1}\NormalTok{, param2=}\DecValTok{7}\NormalTok{)  }\CommentTok{# correct, aggr = ()}
\NormalTok{function(param2=}\DecValTok{8}\NormalTok{)  }\CommentTok{# incorrect, param1 needs a value}
\NormalTok{function(param2=}\DecValTok{0}\NormalTok{, param1=}\DecValTok{6}\NormalTok{)  }\CommentTok{# correct}
\end{Highlighting}
\end{Shaded}

The type of an aggregate is \textbf{always} \texttt{tuple}.

\end{frame}

\begin{frame}[fragile]

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{f(*args):}
    \DataTypeTok{print}\NormalTok{(}\DataTypeTok{type}\NormalTok{(args)) }\CommentTok{# ==> tuple}
\end{Highlighting}
\end{Shaded}

As you can see a function can have only an aggregate as a parameter. If
no argument is passed to the aggregate \texttt{len(args)\ ==\ 0}, if one
is passed \texttt{len(args)\ ==\ 1} etc. If the aggregate is the only
parameter it is often named \texttt{args} (short for `arguments').

\end{frame}

\begin{frame}[fragile]

The aggregaor operator \texttt{*} may also occur without a name
(python3), in which case it'll simply force any subsequent (named)
parameters have to be called by name, and cannot be called positionally.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{function(param1, param2, *, param3=}\DecValTok{6}\NormalTok{):}
    \KeywordTok{pass}
\end{Highlighting}
\end{Shaded}

\end{frame}

\begin{frame}[fragile]

\begin{block}{Named}

Analog to the positional aggregate there's an aggregate for named values
also. It is denoted using the \texttt{**} operator (pronounced `star
star', aka \texttt{**kwargs} is pronounced `key duouble u args star
star'). The named aggregator only aggregates named arguments and is of
type \texttt{dict}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{function(param1, **aggr):}
    \KeywordTok{pass}

\NormalTok{function(}\DecValTok{1}\NormalTok{)  }\CommentTok{# correct, aggr = \{\}}
\NormalTok{function(}\DecValTok{1}\NormalTok{, some=}\DecValTok{9}\NormalTok{)  }\CommentTok{# correct, aggr = \{'some':9\}}
\NormalTok{function(some=}\DecValTok{6}\NormalTok{)  }\CommentTok{# incorrect, param1 requires a value}
\NormalTok{function(some=}\DecValTok{0}\NormalTok{, param1=}\DecValTok{8}\NormalTok{, param2=}\DecValTok{4}\NormalTok{)  }
\CommentTok{# correct, aggr = \{'some':0, 'param2':4\}}
\end{Highlighting}
\end{Shaded}

If a function has no named arguments besides the aggregator, it is often
named \texttt{kwargs} (keyword args).

\end{block}

\end{frame}

\begin{frame}[fragile]

\begin{block}{Mixing}

Both aggregators can be used simultaneously in one function. The rule
is, that each aggregator can only occur once.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def} \NormalTok{function(}
        \NormalTok{param1,}
        \NormalTok{param2,}
        \NormalTok{*args,}
        \NormalTok{kwparam1=}\DecValTok{0}\NormalTok{,}
        \NormalTok{kwparam2=}\OtherTok{None}\NormalTok{,}
        \NormalTok{**kwargs}
    \NormalTok{):}
    \KeywordTok{pass}
\end{Highlighting}
\end{Shaded}

\end{block}

\end{frame}

\begin{frame}[fragile]

This leads to the following generalized function signature.

\begin{verbatim}
def name(
        [params, ...]
        [, *[aggregator]]
        [, kwparams=kwvalue, ...]
        [**kwaggreg]
    ):
    pass
\end{verbatim}

\emph{Note that the square brackets mean optional}

\end{frame}
